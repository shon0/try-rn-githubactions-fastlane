name: Create release pull request
on:
  workflow_dispatch:
    branches:
      - master
    inputs:
      bump_type:
        description: 'Bump Type (minor or major)'
        required: true
        default: 'minor'
jobs:
  bump-version-ios:
    name: Bump version iOS
    runs-on: macos-latest
    if: github.event.inputs.bump_type == 'minor' || github.event.inputs.bump_type == 'major'
    steps:
      - name: Checkout code
        uses: actions/checkout@master
        with:
          ref: develop
      - uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: '12.4'
      - name: Increment version
        run: |
          bundle install
          bundle exec fastlane ios bump_version bump_type:${{ github.event.inputs.bump_type }}
  bump-version-android:
    name: Bump version Android
    needs: bump-version-ios
    runs-on: ubuntu-latest
    if: github.event.inputs.bump_type == 'minor' || github.event.inputs.bump_type == 'major'
    steps:
      - name: Checkout code
        uses: actions/checkout@master
        with:
          ref: develop
      - name: Increment version
        run: |
          bundle install
          bundle exec fastlane android bump_version bump_type:${{ env.NEW_VERSION }}