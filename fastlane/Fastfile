platform :ios do
  desc "バージョンの更新"
  lane :bump_version do |options|
    new_version = increment_version_number(
      bump_type: options[:bump_type],
      xcodeproj: "./ios/TryRNGithubactionsFastlane.xcodeproj"
    )

    commit_version_bump(
      message: "Bump bundle version to #{Actions.lane_context[SharedValues::VERSION_NUMBER]} on iOS",
      xcodeproj: "./ios/smaluna.xcodeproj",
      ignore: /smaluna-tvOSTests/,
    )

    sh("echo IOS_NEW_VERSION=#{new_version} >> $GITHUB_ENV")
  end
end

platform :android do
  desc "バージョンの更新"
  lane :bump_version do |options|
    new_version = increment_version_name(
      bump_type: options[:bump_type],
      gradle_file_path: "./android/app/build.gradle",
    )

    commit_android_version_bump(
      message: "Bump bundle version to #{Actions.lane_context[SharedValues::VERSION_NAME]} on Android",
      gradle_file_folder: "android/app",
    )

    sh("echo ANDROID_NEW_VERSION=#{new_version} >> $GITHUB_ENV")
  end
end